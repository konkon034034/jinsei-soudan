# 昭和ランキング動画システム設計

## 概要

「昭和のあれこれ」をテーマにした懐かしランキング動画を自動生成するシステム。
1日2本（横動画+ショート）を自動投稿。

---

## システム構成

```
showa_ranking/
├── showa_ranking.py      # メインスクリプト（単一ファイル）
├── themes.json           # テーマ定義
├── history.json          # 投稿履歴（重複防止）
├── assets/
│   └── fonts/            # フォント
└── temp/                 # 一時ファイル（自動削除）
```

---

## テーマ一覧（20種類）

| # | テーマ | データ項目 |
|---|--------|-----------|
| 1 | 昭和の俳優 | 名前, 生年, 代表作, 受賞歴 |
| 2 | 昭和の女優 | 名前, 生年, 代表作, 受賞歴 |
| 3 | 昭和の歌手 | 名前, 代表曲, 売上枚数, 活動期間 |
| 4 | 昭和のアイドル | 名前, デビュー年, 代表曲, グループ名 |
| 5 | 昭和の芸人 | 名前/コンビ名, デビュー年, 代表ネタ, 受賞歴 |
| 6 | 昭和のお菓子 | 商品名, 発売年, メーカー, 当時の価格 |
| 7 | 昭和の家電 | 商品名, 発売年, メーカー, 当時の価格 |
| 8 | 昭和の車 | 車名, 発売年, メーカー, 当時の価格 |
| 9 | 昭和の流行語 | 流行語, 流行年, 由来, 使用例 |
| 10 | 昭和の大事件 | 事件名, 発生年, 概要, 影響 |
| 11 | 昭和の遊園地 | 名称, 開園年, 所在地, 閉園年 |
| 12 | 昭和のデパート | 名称, 開業年, 所在地, 特徴 |
| 13 | 昭和の映画 | タイトル, 公開年, 監督, 興行収入 |
| 14 | 昭和のドラマ | タイトル, 放送年, 主演, 視聴率 |
| 15 | 昭和のアニメ | タイトル, 放送年, 制作会社, 視聴率 |
| 16 | 昭和の玩具 | 商品名, 発売年, メーカー, 当時の価格 |
| 17 | 昭和のプロ野球選手 | 名前, 所属チーム, 成績, 受賞歴 |
| 18 | 昭和の力士 | 四股名, 最高位, 優勝回数, 活動期間 |
| 19 | 昭和の物価比較 | 品目, 昭和の価格, 令和の価格, 倍率 |
| 20 | 昭和の名曲 | 曲名, 歌手, 発売年, 売上枚数 |

---

## パネルデザイン

### 共通仕様
- パネルサイズ: 400px × 900px（縦長）
- パネル間隔: 2px（黒仕切り）
- 背景: ダークグレー (#1A1A1A)

### パネル構成
```
┌─────────────────┐
│   順位 (緑)      │  80px
├─────────────────┤
│                 │
│   画像エリア     │  500px
│                 │
├─────────────────┤
│   名前          │  60px
├─────────────────┤
│   データ1       │  40px
│   データ2       │  40px
│   データ3       │  40px
├─────────────────┤
│   補足情報       │  140px
└─────────────────┘
```

### 色設定
```python
COLORS = {
    "rank_bg": "#2E7D32",      # 順位背景（緑）
    "panel_bg": "#2D2D2D",     # パネル背景
    "name_text": "#FFFFFF",    # 名前（白）
    "data_text": "#B0B0B0",    # データ（グレー）
    "highlight": "#FFB300",    # ハイライト（金）
    "divider": "#000000",      # 仕切り（黒）
}
```

---

## 動画仕様

### 横動画（YouTube通常）
- 解像度: 1920 × 1080
- 同時表示: 4パネル
- スクロール速度: 3秒/パネル
- 総パネル数: 30枚
- 動画時間: 約90秒（1.5分）

### ショート動画（YouTube Shorts）
- 解像度: 1080 × 1920
- 同時表示: 1パネル（中央配置）
- スクロール速度: 2秒/パネル
- 総パネル数: 10枚（上位10のみ）
- 動画時間: 約20秒

---

## 処理フロー

```
┌─────────────────────────────────────────────────────────┐
│ 1. テーマ選択                                           │
│    - themes.json からランダム選択                       │
│    - history.json で重複チェック                        │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 2. データ生成（Gemini API）                             │
│    - テーマに応じたプロンプト                           │
│    - 30項目のランキングデータをJSON生成                 │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 3. 画像取得                                             │
│    - Google画像検索 or Gemini画像生成                   │
│    - 400×500px にリサイズ                               │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 4. パネル画像生成（PIL）                                │
│    - 30枚のパネル画像を生成                             │
│    - temp/panels/ に保存                                │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 5. 横動画生成（ffmpeg）                                 │
│    - パネルを横に並べた長い画像を作成                   │
│    - 左→右にスクロールする動画を生成                    │
│    - BGMを追加                                          │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 6. ショート動画生成（ffmpeg）                           │
│    - 上位10パネルのみ使用                               │
│    - 縦画面用に配置                                     │
│    - 左→右にスクロールする動画を生成                    │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 7. YouTubeアップロード                                  │
│    - 横動画 → 通常動画として投稿                        │
│    - ショート動画 → Shorts として投稿                   │
│    - タイトル・説明文・タグを自動設定                   │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│ 8. 通知・記録                                           │
│    - Discord通知（動画URL）                             │
│    - history.json に投稿履歴を記録                      │
│    - temp/ をクリーンアップ                             │
└─────────────────────────────────────────────────────────┘
```

---

## Geminiプロンプト設計

### データ生成プロンプト
```
あなたは昭和時代（1926-1989年）の日本文化に詳しい専門家です。

【テーマ】{theme_name}

以下の条件でランキングデータを30件生成してください：

1. 昭和時代に活躍した/流行した/発売されたものに限定
2. 一般的な知名度・人気度でランキング
3. 各項目には以下のデータを含める：
   - rank: 順位（1-30）
   - name: 名前/商品名
   - {field1}: {description1}
   - {field2}: {description2}
   - {field3}: {description3}
   - image_query: 画像検索用キーワード（日本語）

【出力形式】
JSON配列で出力してください。
```

### タイトル生成プロンプト
```
以下のテーマで、YouTube動画のタイトルを生成してください。

【テーマ】{theme_name}
【条件】
- 30文字以内
- 昭和懐古を感じさせる
- 視聴者の興味を引く
- 例：「昭和の名俳優ベスト30！今も語り継がれる銀幕スター」

タイトルのみを出力してください。
```

---

## BGM

### 使用BGM（フリー素材）
- 昭和レトロ風BGM
- 保存先: `assets/bgm/showa_retro.mp3`
- 長さ: ループ可能な30秒程度

---

## YouTube設定

### 横動画
```python
{
    "title": "{生成タイトル}",
    "description": """昭和時代の懐かしい{theme}をランキング形式でご紹介！

あの頃を思い出しながらお楽しみください。

#昭和 #懐かしい #ランキング #{theme}""",
    "tags": ["昭和", "懐かしい", "ランキング", "{theme}", "レトロ"],
    "category": "22",  # People & Blogs
    "privacy": "public"
}
```

### ショート動画
```python
{
    "title": "{生成タイトル} #shorts",
    "description": "昭和の{theme}TOP10！ #shorts #昭和 #懐かしい",
    "tags": ["shorts", "昭和", "懐かしい", "{theme}"],
    "category": "22",
    "privacy": "public"
}
```

---

## 実行コマンド

```bash
# 通常実行（横動画+ショート動画を生成・アップロード）
python3 ~/jinsei-soudan/showa_ranking/showa_ranking.py

# テーマ指定
python3 ~/jinsei-soudan/showa_ranking/showa_ranking.py --theme "昭和の俳優"

# プレビューモード（アップロードなし、デスクトップ保存）
python3 ~/jinsei-soudan/showa_ranking/showa_ranking.py --preview

# ショート動画のみ
python3 ~/jinsei-soudan/showa_ranking/showa_ranking.py --shorts-only
```

---

## GitHub Actions（自動実行）

```yaml
name: Showa Ranking Daily

on:
  schedule:
    - cron: '0 21 * * *'  # 毎日06:00 JST
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - name: Install dependencies
        run: pip install -r requirements.txt
      - name: Run Showa Ranking
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          YOUTUBE_CREDENTIALS: ${{ secrets.YOUTUBE_CREDENTIALS }}
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: python showa_ranking/showa_ranking.py
```

---

## 次のステップ

1. ✅ 設計完了
2. ⬜ themes.json 作成
3. ⬜ パネル生成テスト
4. ⬜ showa_ranking.py 実装
5. ⬜ 動画生成テスト
6. ⬜ YouTube投稿テスト
7. ⬜ GitHub Actions設定
